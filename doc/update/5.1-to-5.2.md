# From 5.1 to 5.2

### 1. Stop server

    sudo service gitlab stop

### 2. Get latest code

```bash
cd /home/git/gitlab
sudo -u git -H git fetch
sudo -u git -H git checkout 5-2-stable
```

### 3. Update gitlab-shell

```bash
cd /home/git/gitlab-shell
sudo -u git -H git fetch
sudo -u git -H git checkout v1.4.0
```

### 4. Install libs, migrations etc

```bash
cd /home/git/gitlab
sudo -u git -H bundle install --without development test postgres --deployment
sudo -u git -H bundle exec rake db:migrate RAILS_ENV=production
```

### Check config files up to date

* Make sure `/etc/nginx/sites-available/gitlab` is same as https://github.com/gitlabhq/gitlabhq/blob/5-2-stable/lib/support/nginx/gitlab but with your settings.
* Make sure `/home/git/gitlab-shell/config.yml` is same as https://github.com/gitlabhq/gitlab-shell/blob/v1.4.0/config.yml.example but with your settings.
* Make sure `/home/git/gitlab/config/config.yml` is same as https://github.com/gitlabhq/gitlabhq/blob/5-2-stable/config/gitlab.yml.example but with your settings.
* Make sure `/home/git/gitlab/config/puma.rb` is same as https://github.com/gitlabhq/gitlabhq/blob/5-2-stable/config/puma.rb.example but with your settings.

#### MySQL Database
Make sure `/home/git/gitlab/config/database.yml` is same as https://github.com/gitlabhq/gitlabhq/blob/5-2-stable/config/database.yml.mysql but with your settings.

#### PostgreSQL Database
Make sure `/home/git/gitlab/config/database.yml` is same as https://github.com/gitlabhq/gitlabhq/blob/5-2-stable/config/database.yml.postgresql but with your settings.

### 5. Start application

    sudo service gitlab start
    sudo service nginx restart
