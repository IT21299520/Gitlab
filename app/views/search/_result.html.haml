%fieldset
  %legend
    Search results
    %span.cgray (#{@total_results})

- is_search_code = params[:search_code] == "true"

%ul.nav.nav-pills
  %li{class: ("active" if not is_search_code)}
    = link_to search_path(params.merge(search_code: nil)) do
      Everything else
  %li{class: ("active" if is_search_code)}
    = link_to search_path(params.merge(search_code: true)) do
      Repository Code

.search_results
  %ul.bordered-list
    - if not is_search_code 
      - @projects.each do |project|
        %li
          project:
          = link_to project do
            %strong.term= project.name_with_namespace
      - @merge_requests.each do |merge_request|
        %li
          merge request:
          = link_to [merge_request.project, merge_request] do
            %span ##{merge_request.id}
            %strong.term
              = truncate merge_request.title, length: 50
          %span.light (#{merge_request.project.name_with_namespace})
      - @issues.each do |issue|
        %li
          issue:
          = link_to [issue.project, issue] do
            %span ##{issue.id}
            %strong.term
              = truncate issue.title, length: 50
          %span.light (#{issue.project.name_with_namespace})
      - @wiki_pages.each do |wiki_page|
        %li
          wiki:
          = link_to project_wiki_path(wiki_page.project, wiki_page) do
            %strong.term
              = truncate wiki_page.title, length: 50
          %span.light (#{wiki_page.project.name_with_namespace})
    - else
      - @blobs.each do |blob_result|
        = render 'blob', blob: blob_result 

  = paginate @blobs, theme: 'gitlab' if is_search_code

:javascript
  $(function() {
    $(".search_results .term").highlight("#{escape_javascript(params[:search])}");
  })

