# From 7.4 to 7.5

### 1. Update config files

#### New configuration options for gitlab.yml

#### MySQL Databases: Update database.yml config file

* Change `collation: utf8_general_ci` to `collation: utf8_unicode_ci` in `config/database.yml` like seen in [config/database.yml.mysql](/config/database.yml.mysql)

```
sudo -u git -H editor config/database.yml
```

### 1. Optional optimizations for GitLab setups with MySQL databases

If you are not experiencing any issues you may not need the following instructions however following them will bring your database in line with the latest recommended installation configuration and help avoid future issues. Be sure to follow these directions exactly. These directions should be safe for any MySQL instance but to be sure make a current MySQL database backup beforehand.

```
# Stop GitLab
sudo service gitlab stop

# Login to MySQL
mysql -u root -p

# do not type the 'mysql>', this is part of the prompt

# Convert all tables to correct character set
SET foreign_key_checks = 0;
SELECT CONCAT('ALTER TABLE gitlabhq_production.', table_name, ' CONVERT TO CHARACTER SET utf8 COLLATE utf8_unicode_ci;') AS 'Copy & run these SQL statements:' FROM information_schema.tables WHERE table_schema = 'gitlabhq_production' AND `TABLE_COLLATION` <> 'utf8_unicode_ci' AND `TABLE_TYPE` = 'BASE TABLE';

# If previous query returned results, copy & run all outputed SQL statements

# turn foreign key checks back on
SET foreign_key_checks = 1;

mysql> \q

# Start gitlab
sudo service gitlab start
sudo service nginx restart

# Run thorough check
sudo -u git -H bundle exec rake gitlab:check RAILS_ENV=production
```
