.main_box
  .top_box_content
    .right
      - unless @notes_count.zero?
        %span.btn.small.disabled.padded= pluralize @notes_count, t('.note'), t('.notes')

      = link_to tree_project_ref_path(@project, @commit.id), :class => "btn small" do 
        = t 'commits.commit.browse'
    = image_tag gravatar_icon(@commit.author_email), :class => "avatar"
    %code= @commit.id.to_s
    %h5
      = @commit.author_name
      %small= @commit.created_at.stamp(t('global.full_timestamp'))
      - if @commit.author_name != @commit.committer_name or @commit.author_email != @commit.committer_email or @commit.authored_date != @commit.committed_date 
        &ndash;
        %cite
          = t '.committed_by'
        = @commit.committer_name
        %small= @commit.committed_date.stamp(t('global.full_timestamp'))

  .middle_box_content
    %pre.commit_message
      = commit_msg_with_link_to_issues(@project, @commit.safe_message)
%br
= render "commits/diffs", :diffs => @commit.diffs
= render "notes/notes", :tid => @commit.id, :tt => "commit"
= render "notes/per_line_form"


:javascript
  $(document).ready(function(){
    $(".line_note_link, .line_note_reply_link").live("click", function(e) { 
      var form = $(".per_line_form");
      $(this).parent().parent().after(form);
      form.find("#note_line_code").val($(this).attr("line_code"));
      form.show();  
      return false;
    });
  });
